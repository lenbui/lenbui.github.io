<!DOCTYPE html>
<!-- saved from url=(0063)https://keras.io/examples/vision/xray_classification_with_tpus/ -->
<html lang="vi" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Keras documentation">
  <meta name="author" content="Keras Team">
  <link rel="shortcut icon" href="https://keras.io/img/favicon.ico">
  
  <link rel="canonical" href="https://keras.io/examples/vision/xray_classification_with_tpus/">
  

  <!-- Social -->
  <meta property="og:title" content="Keras documentation: Pneumonia Classification on TPU">
  <meta property="og:image" content="https://keras.io/img/logo-k-keras-wb.png">
  <meta name="twitter:title" content="Keras documentation: Pneumonia Classification on TPU">
  <meta name="twitter:image" content="https://keras.io/img/k-keras-social.png">
  <meta name="twitter:card" content="summary">

  <title>Phân loại viêm phổi trên TPU</title>

  <!-- Bootstrap core CSS -->
  <link href="./aaa_files/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="./aaa_files/css2" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="./aaa_files/docs.css" rel="stylesheet">
  <link href="./aaa_files/monokai.css" rel="stylesheet">

  <!-- Google Tag Manager -->
  <script type="text/javascript" async="" src="./aaa_files/js"></script><script async="" src="./aaa_files/analytics.js.download"></script><script async="" src="./aaa_files/gtm.js.download"></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5DNGF4N');
  </script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-175165319-128', 'auto');
  ga('send', 'pageview');
  </script>
  <!-- End Google Tag Manager -->

  <script async="" defer="" src="./aaa_files/buttons.js.download"></script>

<link type="text/css" rel="stylesheet" charset="UTF-8" href="./aaa_files/m=el_main_css"></head>

<body data-new-gr-c-s-check-loaded="14.1196.0" data-gr-ext-installed="">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5DNGF4N"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="k-page">
  
    <div class="k-nav" id="nav-menu" style="display: block;">
      <a href="https://keras.io/"><img src="./aaa_files/logo-small.png" class="logo-small"></a>

      <div class="nav flex-column nav-pills" role="tablist" aria-orientation="vertical">

        
          <a class="nav-link" href="https://keras.io/about/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Giới thiệu về Keras</font></font></a>
          
        
          <a class="nav-link" href="https://keras.io/getting_started/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bắt đầu</font></font></a>
          
        
          <a class="nav-link" href="https://keras.io/guides/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hướng dẫn dành cho nhà phát triển</font></font></a>
          
        
          <a class="nav-link" href="https://keras.io/api/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tài liệu API Keras 3</font></font></a>
          
        
          <a class="nav-link" href="https://keras.io/2.17/api/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tài liệu API Keras 2</font></font></a>
          
        
          <a class="nav-link active" href="https://keras.io/examples/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ví dụ về mã</font></font></a>
          
            
              <a class="nav-sublink active" href="https://keras.io/examples/vision/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tầm nhìn máy tính</font></font></a>
                
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/image_classification_from_scratch/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh từ đầu</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/mnist_convnet/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mạng lưới MNIST đơn giản</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/image_classification_efficientnet_fine_tuning/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh thông qua tinh chỉnh với EfficientNet</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/image_classification_with_vision_transformer/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh với Vision Transformer</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/attention_mil_classification/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại sử dụng Học sâu nhiều trường hợp dựa trên sự chú ý</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/mlp_image_classification/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh với các mô hình MLP hiện đại</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/mobilevit/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Một mô hình dựa trên Transformer thân thiện với thiết bị di động để phân loại hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2 active" href="https://keras.io/examples/vision/xray_classification_with_tpus/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại viêm phổi trên TPU</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/cct/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biến đổi tích chập nhỏ gọn</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/convmixer/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh với ConvMixer</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/eanet/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh với EANet (External Attention Transformer)</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/involution/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mạng lưới thần kinh tiến hóa</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/perceiver_image_classification/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh với Perceiver</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/reptile/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học ít lần với Reptile</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/semisupervised_simclr/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh bán giám sát sử dụng tiền huấn luyện tương phản với SimCLR</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/swin_transformers/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh với Swin Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/vit_small_ds/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Đào tạo Vision Transformer trên các tập dữ liệu nhỏ</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/shiftvit/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Một máy biến đổi tầm nhìn không có sự chú ý</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/image_classification_using_global_context_vision_transformer/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh sử dụng Global Context Vision Transformer</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/oxford_pets_image_segmentation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn hình ảnh với kiến ​​trúc giống U-Net</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/deeplabv3_plus/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn ngữ nghĩa đa lớp sử dụng DeepLabV3+</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/basnet_segmentation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn ranh giới có độ chính xác cao bằng BASNet</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/fully_convolutional_network/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn hình ảnh bằng cách sử dụng mạng tích chập hoàn toàn có thể cấu hình</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/retinanet/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phát hiện đối tượng với RetinaNet</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/keypoint_detection/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phát hiện điểm chính với Chuyển giao học tập</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/object_detection_using_vision_transformer/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phát hiện đối tượng với Vision Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/3D_image_classification/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh 3D từ CT scan</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/depth_estimation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ước tính độ sâu đơn nhãn</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/nerf/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kết xuất thể tích 3D với NeRF</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/pointnet_segmentation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn đám mây điểm với PointNet</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/pointnet/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại đám mây điểm</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/captcha_ocr/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mô hình OCR để đọc Captchas</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/handwriting_recognition/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nhận dạng chữ viết tay</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/autoencoder/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bộ mã hóa tự động tích chập để khử nhiễu hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/mirnet/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cải thiện hình ảnh thiếu sáng bằng MIRNet</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/super_resolution_sub_pixel/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Độ phân giải siêu cao của hình ảnh sử dụng CNN phụ điểm ảnh hiệu quả</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/edsr/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mạng lưới dư lượng sâu được cải tiến cho độ phân giải siêu hình ảnh đơn</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/zero_dce/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zero-DCE để cải thiện hình ảnh thiếu sáng</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/cutmix/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tăng cường dữ liệu CutMix để phân loại hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/mixup/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tăng cường MixUp để phân loại hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/randaugment/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RandAugment để phân loại hình ảnh nhằm cải thiện tính mạnh mẽ</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/image_captioning/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chú thích hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/nl_image_search/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tìm kiếm hình ảnh ngôn ngữ tự nhiên với Dual Encoder</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/visualizing_what_convnets_learn/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hình dung những gì convnets học được</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/integrated_gradients/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Khả năng diễn giải mô hình với Gradient tích hợp</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/probing_vits/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Điều tra các biểu diễn của Vision Transformer</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/grad_cam/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hình ảnh kích hoạt lớp Grad-CAM</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/near_dup_search/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tìm kiếm hình ảnh gần trùng lặp</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/semantic_image_clustering/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân cụm hình ảnh ngữ nghĩa</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/siamese_contrastive/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ước tính độ tương đồng của hình ảnh bằng cách sử dụng Mạng Xiêm với độ mất tương phản</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/siamese_network/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ước tính độ tương đồng của hình ảnh bằng cách sử dụng Mạng Xiêm với mất mát bộ ba</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/metric_learning/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học số liệu để tìm kiếm sự tương đồng của hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/metric_learning_tf_similarity/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học số liệu để tìm kiếm sự tương đồng của hình ảnh bằng cách sử dụng TensorFlow Similarity</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/nnclr/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học tập tương phản tự giám sát với NNCLR</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/video_classification/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại video với kiến ​​trúc CNN-RNN</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/conv_lstm/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dự đoán video khung hình tiếp theo với LSTM tích chập</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/video_transformers/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại video với Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/vivit/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Máy biến đổi hình ảnh video</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/bit/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại hình ảnh sử dụng BigTransfer (BiT)</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/gradient_centralization/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tập trung Gradient để có hiệu suất đào tạo tốt hơn</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/token_learner/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học cách phân tích trong Vision Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/knowledge_distillation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chưng cất kiến ​​thức</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/fixres/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FixRes: Sửa lỗi độ phân giải giữa train và test không đồng đều</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/cait/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lớp chú ý Image Transformers với LayerScale</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/patch_convnet/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tăng cường convnet với sự chú ý tổng hợp</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/learnable_resizer/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học cách thay đổi kích thước</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/adamatch/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Giám sát bán phần và điều chỉnh miền với AdaMatch</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/barlow_twins/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Barlow Twins cho SSL tương phản</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/consistency_training/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Đào tạo tính nhất quán với sự giám sát</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/deit/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chưng cất Vision Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/focal_modulation_network/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Điều chế tiêu điểm: Một sự thay thế cho sự chú ý bản thân</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/forwardforward/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sử dụng thuật toán Forward-Forward để phân loại hình ảnh</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/masked_image_modeling/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mô hình hóa hình ảnh có mặt nạ với Autoencoders</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/sam/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn bất kỳ mô hình nào với 🤗Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/segformer/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân đoạn ngữ nghĩa với SegFormer và Hugging Face Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/simsiam/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học tập tương phản tự giám sát với SimSiam</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/supervised-contrastive-learning/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học tương phản có giám sát</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/temporal_latent_bottleneck/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Khi sự tái diễn gặp Transformers</font></font></a>
                  
                    <a class="nav-sublink2" href="https://keras.io/examples/vision/yolov8/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phát hiện đối tượng hiệu quả với YOLOV8 và KerasCV</font></font></a>
                  
                
            
              <a class="nav-sublink" href="https://keras.io/examples/nlp/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xử lý ngôn ngữ tự nhiên</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/structured_data/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dữ liệu có cấu trúc</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/timeseries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chuỗi thời gian</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/generative/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học sâu tạo sinh</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/audio/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dữ liệu âm thanh</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/rl/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Học tăng cường</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/graph/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dữ liệu đồ thị</font></font></a>
                
            
              <a class="nav-sublink" href="https://keras.io/examples/keras_recipes/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Công thức nấu ăn Keras nhanh</font></font></a>
                
            
          
        
          <a class="nav-link" href="https://keras.io/keras_tuner/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KerasTuner: Điều chỉnh siêu tham số</font></font></a>
          
        
          <a class="nav-link" href="https://keras.io/keras_cv/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KerasCV: Quy trình làm việc của thị giác máy tính</font></font></a>
          
        
          <a class="nav-link" href="https://keras.io/keras_nlp/" role="tab" aria-selected=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KerasNLP: Quy trình làm việc ngôn ngữ tự nhiên</font></font></a>
          
        

      </div>

    </div>

    <div class="k-main">
      
      <div class="k-main-top">
        <script>
          function displayDropdownMenu() {
            e = document.getElementById("nav-menu");
            if (e.style.display == "block") {
              e.style.display = "none";
            }
            else {
              e.style.display = "block";
              document.getElementById("dropdown-nav").style.display = "block";
            }
          }

          function resetMobileUI() {
            if (window.innerWidth <= 840) {
              document.getElementById("nav-menu").style.display = "none";
              document.getElementById("dropdown-nav").style.display = "block";
            }
            else {
              document.getElementById("nav-menu").style.display = "block";
              document.getElementById("dropdown-nav").style.display = "none";
            }

            var navmenu = document.getElementById("nav-menu");
            var menuheight = navmenu.clientHeight;
            var kmain = document.getElementById("k-main-id");
            kmain.style.minHeight = (menuheight + 100) + 'px';
          }

          window.onresize = resetMobileUI;

          window.addEventListener("load", (event) => {
            resetMobileUI()
          });
        </script>
        <div id="dropdown-nav" onclick="displayDropdownMenu();" style="display: none;">
          <svg viewBox="-20 -20 120 120" width="60" height="60">
            <rect width="100" height="20"></rect>
            <rect y="30" width="100" height="20"></rect>
            <rect y="60" width="100" height="20"></rect>
          </svg>
        </div>

        <form class="bd-search d-flex align-items-center k-search-form" id="search-form">
          <input type="search" class="k-search-input" id="search-input" placeholder="Tìm kiếm tài liệu Keras..." aria-label="Tìm kiếm tài liệu Keras..." autocomplete="off">
            <button class="k-search-btn">
              <svg width="13" height="13" viewBox="0 0 13 13"><title>search</title><path d="m4.8495 7.8226c0.82666 0 1.5262-0.29146 2.0985-0.87438 0.57232-0.58292 0.86378-1.2877 0.87438-2.1144 0.010599-0.82666-0.28086-1.5262-0.87438-2.0985-0.59352-0.57232-1.293-0.86378-2.0985-0.87438-0.8055-0.010599-1.5103 0.28086-2.1144 0.87438-0.60414 0.59352-0.8956 1.293-0.87438 2.0985 0.021197 0.8055 0.31266 1.5103 0.87438 2.1144 0.56172 0.60414 1.2665 0.8956 2.1144 0.87438zm4.4695 0.2115 3.681 3.6819-1.259 1.284-3.6817-3.7 0.0019784-0.69479-0.090043-0.098846c-0.87973 0.76087-1.92 1.1413-3.1207 1.1413-1.3553 0-2.5025-0.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239c0-1.3553 0.4696-2.4966 1.4088-3.4239 0.9392-0.92727 2.0864-1.3969 3.4417-1.4088 1.3553-0.011889 2.4906 0.45771 3.406 1.4088 0.9154 0.95107 1.379 2.0924 1.3909 3.4239 0 1.2126-0.38043 2.2588-1.1413 3.1385l0.098834 0.090049z"></path></svg>
            </button>
        </form>
        <script>
          var form = document.getElementById('search-form');
          form.onsubmit = function(e) {
            e.preventDefault();
            var query = document.getElementById('search-input').value;
            window.location.href = '/search.html?query=' + query;
            return False
          }
        </script>

      </div>
      <div class="k-main-inner" id="k-main-id" style="min-height: 4520px;">
        <div class="k-location-slug">
            <span class="k-location-slug-pointer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">► </font></font></span> 
                <a href="https://keras.io/examples/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ví dụ mã</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /
              
                 </font></font><a href="https://keras.io/examples/vision/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tầm nhìn máy tính</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Phân loại viêm phổi trên TPU
        </font></font></div>
        <div class="k-content">
          <h1 id="pneumonia-classification-on-tpu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại viêm phổi trên TPU</font></font></h1>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tác giả:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Amy MiHyun Jang </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ngày tạo:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 28/07/2020 </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ngày sửa đổi lần cuối:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 12/02/2024 </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mô tả:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Phân loại hình ảnh y tế trên TPU.</font></font></p>
<div class="example_version_banner keras_3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ⓘ Ví dụ này sử dụng Keras 3</font></font></div>
<p><img class="k-inline-icon" src="./aaa_files/colab_favicon.ico"> <a href="https://colab.research.google.com/github/keras-team/keras-io/blob/master/examples/vision/ipynb/xray_classification_with_tpus.ipynb"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xem trong Colab</font></font></strong></a>  <span class="k-dot"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> • </font></font></span><img class="k-inline-icon" src="./aaa_files/favicon.ico"> <a href="https://github.com/keras-team/keras-io/blob/master/examples/vision/xray_classification_with_tpus.py"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nguồn GitHub</font></font></strong></a></p>
<hr>
<h2 id="introduction--setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Giới thiệu + Thiết lập</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hướng dẫn này sẽ giải thích cách xây dựng mô hình phân loại hình ảnh X-quang để dự đoán liệu chụp X-quang có phát hiện bệnh viêm phổi hay không.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span><font></font>
<font></font>
<span class="k">try</span><span class="p">:</span>
    <span class="n">tpu</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">cluster_resolver</span><span class="o">.</span><span class="n">TPUClusterResolver</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Device:"</span><span class="p">,</span> <span class="n">tpu</span><span class="o">.</span><span class="n">master</span><span class="p">())</span>
    <span class="n">strategy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">TPUStrategy</span><span class="p">(</span><span class="n">tpu</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">strategy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">get_strategy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Number of replicas:"</span><span class="p">,</span> <span class="n">strategy</span><span class="o">.</span><span class="n">num_replicas_in_sync</span><span class="p">)</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>Device: grpc://10.0.27.122:8470<font></font>
INFO:tensorflow:Initializing the TPU system: grpc://10.0.27.122:8470<font></font>
<font></font>
INFO:tensorflow:Initializing the TPU system: grpc://10.0.27.122:8470<font></font>
<font></font>
INFO:tensorflow:Clearing out eager caches<font></font>
<font></font>
INFO:tensorflow:Clearing out eager caches<font></font>
<font></font>
INFO:tensorflow:Finished initializing TPU system.<font></font>
<font></font>
INFO:tensorflow:Finished initializing TPU system.<font></font>
WARNING:absl:[`tf.distribute.TPUStrategy`](https://www.tensorflow.org/api_docs/python/tf/distribute/TPUStrategy) is deprecated, please use  the non experimental symbol [`tf.distribute.TPUStrategy`](https://www.tensorflow.org/api_docs/python/tf/distribute/TPUStrategy) instead.<font></font>
<font></font>
INFO:tensorflow:Found TPU system:<font></font>
<font></font>
INFO:tensorflow:Found TPU system:<font></font>
<font></font>
INFO:tensorflow:*** Num TPU Cores: 8<font></font>
<font></font>
INFO:tensorflow:*** Num TPU Cores: 8<font></font>
<font></font>
INFO:tensorflow:*** Num TPU Workers: 1<font></font>
<font></font>
INFO:tensorflow:*** Num TPU Workers: 1<font></font>
<font></font>
INFO:tensorflow:*** Num TPU Cores Per Worker: 8<font></font>
<font></font>
INFO:tensorflow:*** Num TPU Cores Per Worker: 8<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)<font></font>
<font></font>
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)<font></font>
<font></font>
Number of replicas: 8<font></font>
</code></pre></div>


</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chúng tôi cần liên kết Google Cloud đến dữ liệu của mình để tải dữ liệu bằng TPU. Dưới đây, chúng tôi xác định các tham số cấu hình chính mà chúng tôi sẽ sử dụng trong ví dụ này. Để chạy trên TPU, ví dụ này phải ở trên Colab với thời gian chạy TPU được chọn.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">AUTOTUNE</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AUTOTUNE</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">strategy</span><span class="o">.</span><span class="n">num_replicas_in_sync</span>
<span class="n">IMAGE_SIZE</span> <span class="o">=</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
<span class="n">CLASS_NAMES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"NORMAL"</span><span class="p">,</span> <span class="s2">"PNEUMONIA"</span><span class="p">]</span>
</code></pre></div>

<hr>
<h2 id="load-the-data"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tải dữ liệu</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dữ liệu X-quang ngực mà chúng tôi sử dụng từ
 </font></font><a href="https://www.cell.com/cell/fulltext/S0092-8674(18)30154-5"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cell</font></font></em></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chia dữ liệu thành các tệp đào tạo và kiểm tra. Trước tiên, hãy tải TFRecords đào tạo.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">train_images</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span>
    <span class="s2">"gs://download.tensorflow.org/data/ChestXRay2017/train/images.tfrec"</span>
<span class="p">)</span>
<span class="n">train_paths</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span>
    <span class="s2">"gs://download.tensorflow.org/data/ChestXRay2017/train/paths.tfrec"</span>
<span class="p">)</span><font></font>
<font></font>
<span class="n">ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">zip</span><span class="p">((</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_paths</span><span class="p">))</span>
</code></pre></div>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chúng ta hãy đếm xem có bao nhiêu phim chụp X-quang ngực khỏe mạnh/bình thường và bao nhiêu phim chụp X-quang ngực viêm phổi:</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">COUNT_NORMAL</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">filename</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">train_paths</span>
        <span class="k">if</span> <span class="s2">"NORMAL"</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Normal images count in training set: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">COUNT_NORMAL</span><span class="p">))</span><font></font>
<font></font>
<span class="n">COUNT_PNEUMONIA</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">filename</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">train_paths</span>
        <span class="k">if</span> <span class="s2">"PNEUMONIA"</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Pneumonia images count in training set: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">COUNT_PNEUMONIA</span><span class="p">))</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>Normal images count in training set: 1349<font></font>
Pneumonia images count in training set: 3883<font></font>
</code></pre></div>


</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lưu ý rằng có nhiều hình ảnh được phân loại là viêm phổi hơn bình thường. Điều này cho thấy chúng ta có sự mất cân bằng trong dữ liệu. Chúng ta sẽ hiệu chỉnh sự mất cân bằng này sau trong sổ tay của mình.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chúng tôi muốn ánh xạ từng tên tệp vào cặp (hình ảnh, nhãn) tương ứng. Các phương pháp sau sẽ giúp chúng tôi thực hiện điều đó.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vì chúng ta chỉ có hai nhãn, chúng ta sẽ mã hóa nhãn sao cho </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hoặc </font></font><code>True</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biểu thị bệnh viêm phổi và </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hoặc </font></font><code>False</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biểu thị bình thường.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_label</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># convert the path to a list of path components</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"/"</span><span class="p">)</span>
    <span class="c1"># The second to last is the class-directory</span>
    <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"PNEUMONIA"</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><font></font>
<font></font>
<font></font>
<span class="k">def</span> <span class="nf">decode_img</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    <span class="c1"># convert the compressed string to a 3D uint8 tensor</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">decode_jpeg</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># resize the image to the desired size.</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">)</span><font></font>
<font></font>
<font></font>
<span class="k">def</span> <span class="nf">process_path</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">get_label</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="c1"># load the raw data from the file as a string</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">decode_img</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">label</span><font></font>
<font></font>
<font></font>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">process_path</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
</code></pre></div>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hãy chia dữ liệu thành tập dữ liệu đào tạo và tập dữ liệu xác thực.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">4200</span><span class="p">)</span>
<span class="n">val_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="mi">4200</span><span class="p">)</span>
</code></pre></div>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chúng ta hãy hình dung hình dạng của một cặp (hình ảnh, nhãn).</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Image shape: "</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Label: "</span><span class="p">,</span> <span class="n">label</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>Image shape:  (180, 180, 3)<font></font>
Label:  False<font></font>
</code></pre></div>


</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tải và định dạng dữ liệu thử nghiệm.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">test_images</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span>
    <span class="s2">"gs://download.tensorflow.org/data/ChestXRay2017/test/images.tfrec"</span>
<span class="p">)</span>
<span class="n">test_paths</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span>
    <span class="s2">"gs://download.tensorflow.org/data/ChestXRay2017/test/paths.tfrec"</span>
<span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">zip</span><span class="p">((</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_paths</span><span class="p">))</span><font></font>
<font></font>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">test_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">process_path</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">test_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
</code></pre></div>

<hr>
<h2 id="visualize-the-dataset"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hình dung tập dữ liệu</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Đầu tiên, hãy sử dụng chức năng đệm trước để có thể lấy dữ liệu từ đĩa mà không khiến I/O bị chặn.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xin lưu ý rằng các tập dữ liệu hình ảnh lớn không nên được lưu vào bộ nhớ đệm. Chúng tôi thực hiện điều này ở đây vì tập dữ liệu không quá lớn và chúng tôi muốn đào tạo trên TPU.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_for_training</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="c1"># This is a small dataset, only load it once, and keep it in memory.</span>
    <span class="c1"># use `.cache(filename)` to cache preprocessing work for datasets that don't</span>
    <span class="c1"># fit in memory.</span>
    <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cache</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cache</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><font></font>
<font></font>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span><font></font>
<font></font>
    <span class="c1"># `prefetch` lets the dataset fetch batches in the background while the model</span>
    <span class="c1"># is training.</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">buffer_size</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span><font></font>
<font></font>
    <span class="k">return</span> <span class="n">ds</span>
</code></pre></div>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gọi lần lặp lại tiếp theo của dữ liệu đào tạo.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">train_ds</span> <span class="o">=</span> <span class="n">prepare_for_training</span><span class="p">(</span><span class="n">train_ds</span><span class="p">)</span>
<span class="n">val_ds</span> <span class="o">=</span> <span class="n">prepare_for_training</span><span class="p">(</span><span class="n">val_ds</span><span class="p">)</span><font></font>
<font></font>
<span class="n">image_batch</span><span class="p">,</span> <span class="n">label_batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_ds</span><span class="p">))</span>
</code></pre></div>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xác định phương pháp hiển thị hình ảnh trong lô.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">show_batch</span><span class="p">(</span><span class="n">image_batch</span><span class="p">,</span> <span class="n">label_batch</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_batch</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_batch</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"PNEUMONIA"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"NORMAL"</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
</code></pre></div>

<p>As the method takes in NumPy arrays as its parameters, call the numpy function on the
batches to return the tensor in NumPy array form.</p>
<div class="codehilite"><pre><span></span><code><span class="n">show_batch</span><span class="p">(</span><span class="n">image_batch</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">label_batch</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</code></pre></div>

<p><img alt="png" src="./aaa_files/xray_classification_with_tpus_25_0.png"></p>
<hr>
<h2 id="build-the-cnn">Build the CNN</h2>
<p>To make our model more modular and easier to understand, let's define some blocks. As
we're building a convolution neural network, we'll create a convolution block and a dense
layer block.</p>
<p>The architecture for this CNN has been inspired by this
<a href="https://towardsdatascience.com/deep-learning-for-detecting-pneumonia-from-x-ray-images-fc9a3d9fdba8">article</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span> 
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'KERAS_BACKEND'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'tensorflow'</span><font></font>
<font></font>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span><font></font>
<font></font>
<span class="k">def</span> <span class="nf">conv_block</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">SeparableConv2D</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"same"</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">SeparableConv2D</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"same"</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="k">return</span> <span class="n">outputs</span><font></font>
<font></font>
<font></font>
<span class="k">def</span> <span class="nf">dense_block</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div>

<p>The following method will define the function to build our model for us.</p>
<p>The images originally have values that range from [0, 255]. CNNs work better with smaller
numbers so we will scale this down for our input.</p>
<p>The Dropout layers are important, as they
reduce the likelikhood of the model overfitting. We want to end the model with a <code>Dense</code>
layer with one node, as this will be the binary output that determines if an X-ray shows
presence of pneumonia.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build_model</span><span class="p">():</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">IMAGE_SIZE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">IMAGE_SIZE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Rescaling</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"same"</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"same"</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"sigmoid"</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><font></font>
<font></font>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div>

<hr>
<h2 id="correct-for-data-imbalance">Correct for data imbalance</h2>
<p>We saw earlier in this example that the data was imbalanced, with more images classified
as pneumonia than normal. We will correct for that by using class weighting:</p>
<div class="codehilite"><pre><span></span><code><span class="n">initial_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">([</span><span class="n">COUNT_PNEUMONIA</span> <span class="o">/</span> <span class="n">COUNT_NORMAL</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Initial bias: </span><span class="si">{:.5f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">initial_bias</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><font></font>
<font></font>
<span class="n">TRAIN_IMG_COUNT</span> <span class="o">=</span> <span class="n">COUNT_NORMAL</span> <span class="o">+</span> <span class="n">COUNT_PNEUMONIA</span>
<span class="n">weight_for_0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">COUNT_NORMAL</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TRAIN_IMG_COUNT</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">weight_for_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">COUNT_PNEUMONIA</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TRAIN_IMG_COUNT</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><font></font>
<font></font>
<span class="n">class_weight</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">weight_for_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">weight_for_1</span><span class="p">}</span><font></font>
<font></font>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Weight for class 0: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">weight_for_0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Weight for class 1: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">weight_for_1</span><span class="p">))</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>Initial bias: 1.05724<font></font>
Weight for class 0: 1.94<font></font>
Weight for class 1: 0.67<font></font>
</code></pre></div>


</div>
<p>The weight for class <code>0</code> (Normal) is a lot higher than the weight for class <code>1</code>
(Pneumonia). Because there are less normal images, each normal image will be weighted
more to balance the data as the CNN works best when the training data is balanced.</p>
<hr>
<h2 id="train-the-model">Train the model</h2>
<h3 id="defining-callbacks">Defining callbacks</h3>
<p>The checkpoint callback saves the best weights of the model, so next time we want to use
the model, we do not have to spend time training it. The early stopping callback stops
the training process when the model starts becoming stagnant, or even worse, when the
model starts overfitting.</p>
<div class="codehilite"><pre><span></span><code><span class="n">checkpoint_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s2">"xray_model.keras"</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><font></font>
<font></font>
<span class="n">early_stopping_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span>
    <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<p>We also want to tune our learning rate. Too high of a learning rate will cause the model
to diverge. Too small of a learning rate will cause the model to be too slow. We
implement the exponential learning rate scheduling method below.</p>
<div class="codehilite"><pre><span></span><code><span class="n">initial_learning_rate</span> <span class="o">=</span> <span class="mf">0.015</span>
<span class="n">lr_schedule</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">schedules</span><span class="o">.</span><span class="n">ExponentialDecay</span><span class="p">(</span>
    <span class="n">initial_learning_rate</span><span class="p">,</span> <span class="n">decay_steps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">decay_rate</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span> <span class="n">staircase</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="fit-the-model">Fit the model</h3>
<p>For our metrics, we want to include precision and recall as they will provide use with a
more informed picture of how good our model is. Accuracy tells us what fraction of the
labels is correct. Since our data is not balanced, accuracy might give a skewed sense of
a good model (i.e. a model that always predicts PNEUMONIA will be 74% accurate but is not
a good model).</p>
<p>Precision is the number of true positives (TP) over the sum of TP and false positives
(FP). It shows what fraction of labeled positives are actually correct.</p>
<p>Recall is the number of TP over the sum of TP and false negatves (FN). It shows what
fraction of actual positives are correct.</p>
<p>Since there are only two possible labels for the image, we will be using the
binary crossentropy loss. When we fit the model, remember to specify the class weights,
which we defined earlier. Because we are using a TPU, training will be quick - less than
2 minutes.</p>
<div class="codehilite"><pre><span></span><code><span class="k">with</span> <span class="n">strategy</span><span class="o">.</span><span class="n">scope</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">()</span><font></font>
<font></font>
    <span class="n">METRICS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryAccuracy</span><span class="p">(),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"precision"</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"recall"</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">lr_schedule</span><span class="p">),</span>
        <span class="n">loss</span><span class="o">=</span><span class="s2">"binary_crossentropy"</span><span class="p">,</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">METRICS</span><span class="p">,</span>
    <span class="p">)</span><font></font>
<font></font>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_ds</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">validation_data</span><span class="o">=</span><span class="n">val_ds</span><span class="p">,</span>
    <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint_cb</span><span class="p">,</span> <span class="n">early_stopping_cb</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>Epoch 1/100<font></font>
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/data/ops/multi_device_iterator_ops.py:601: get_next_as_optional (from tensorflow.python.data.ops.iterator_ops) is deprecated and will be removed in a future version.<font></font>
Instructions for updating:<font></font>
Use `tf.data.Iterator.get_next_as_optional()` instead.<font></font>
<font></font>
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/data/ops/multi_device_iterator_ops.py:601: get_next_as_optional (from tensorflow.python.data.ops.iterator_ops) is deprecated and will be removed in a future version.<font></font>
Instructions for updating:<font></font>
Use `tf.data.Iterator.get_next_as_optional()` instead.<font></font>
<font></font>
21/21 [==============================] - 12s 568ms/step - loss: 0.5857 - binary_accuracy: 0.6960 - precision: 0.8887 - recall: 0.6733 - val_loss: 34.0149 - val_binary_accuracy: 0.7180 - val_precision: 0.7180 - val_recall: 1.0000<font></font>
Epoch 2/100<font></font>
21/21 [==============================] - 3s 128ms/step - loss: 0.2916 - binary_accuracy: 0.8755 - precision: 0.9540 - recall: 0.8738 - val_loss: 97.5194 - val_binary_accuracy: 0.7180 - val_precision: 0.7180 - val_recall: 1.0000<font></font>
Epoch 3/100<font></font>
21/21 [==============================] - 4s 167ms/step - loss: 0.2384 - binary_accuracy: 0.9002 - precision: 0.9663 - recall: 0.8964 - val_loss: 27.7902 - val_binary_accuracy: 0.7180 - val_precision: 0.7180 - val_recall: 1.0000<font></font>
Epoch 4/100<font></font>
21/21 [==============================] - 4s 173ms/step - loss: 0.2046 - binary_accuracy: 0.9145 - precision: 0.9725 - recall: 0.9102 - val_loss: 10.8302 - val_binary_accuracy: 0.7180 - val_precision: 0.7180 - val_recall: 1.0000<font></font>
Epoch 5/100<font></font>
21/21 [==============================] - 4s 174ms/step - loss: 0.1841 - binary_accuracy: 0.9279 - precision: 0.9733 - recall: 0.9279 - val_loss: 3.5860 - val_binary_accuracy: 0.7103 - val_precision: 0.7162 - val_recall: 0.9879<font></font>
Epoch 6/100<font></font>
21/21 [==============================] - 4s 185ms/step - loss: 0.1600 - binary_accuracy: 0.9362 - precision: 0.9791 - recall: 0.9337 - val_loss: 0.3014 - val_binary_accuracy: 0.8895 - val_precision: 0.8973 - val_recall: 0.9555<font></font>
Epoch 7/100<font></font>
21/21 [==============================] - 3s 130ms/step - loss: 0.1567 - binary_accuracy: 0.9393 - precision: 0.9798 - recall: 0.9372 - val_loss: 0.6763 - val_binary_accuracy: 0.7810 - val_precision: 0.7760 - val_recall: 0.9771<font></font>
Epoch 8/100<font></font>
21/21 [==============================] - 3s 131ms/step - loss: 0.1532 - binary_accuracy: 0.9421 - precision: 0.9825 - recall: 0.9385 - val_loss: 0.3169 - val_binary_accuracy: 0.8895 - val_precision: 0.8684 - val_recall: 0.9973<font></font>
Epoch 9/100<font></font>
21/21 [==============================] - 4s 184ms/step - loss: 0.1457 - binary_accuracy: 0.9431 - precision: 0.9822 - recall: 0.9401 - val_loss: 0.2064 - val_binary_accuracy: 0.9273 - val_precision: 0.9840 - val_recall: 0.9136<font></font>
Epoch 10/100<font></font>
21/21 [==============================] - 3s 132ms/step - loss: 0.1201 - binary_accuracy: 0.9521 - precision: 0.9869 - recall: 0.9479 - val_loss: 0.4364 - val_binary_accuracy: 0.8605 - val_precision: 0.8443 - val_recall: 0.9879<font></font>
Epoch 11/100<font></font>
21/21 [==============================] - 3s 127ms/step - loss: 0.1200 - binary_accuracy: 0.9510 - precision: 0.9863 - recall: 0.9469 - val_loss: 0.5197 - val_binary_accuracy: 0.8508 - val_precision: 1.0000 - val_recall: 0.7922<font></font>
Epoch 12/100<font></font>
21/21 [==============================] - 4s 186ms/step - loss: 0.1077 - binary_accuracy: 0.9581 - precision: 0.9870 - recall: 0.9559 - val_loss: 0.1349 - val_binary_accuracy: 0.9486 - val_precision: 0.9587 - val_recall: 0.9703<font></font>
Epoch 13/100<font></font>
21/21 [==============================] - 4s 173ms/step - loss: 0.0918 - binary_accuracy: 0.9650 - precision: 0.9914 - recall: 0.9611 - val_loss: 0.0926 - val_binary_accuracy: 0.9700 - val_precision: 0.9837 - val_recall: 0.9744<font></font>
Epoch 14/100<font></font>
21/21 [==============================] - 3s 130ms/step - loss: 0.0996 - binary_accuracy: 0.9612 - precision: 0.9913 - recall: 0.9559 - val_loss: 0.1811 - val_binary_accuracy: 0.9419 - val_precision: 0.9956 - val_recall: 0.9231<font></font>
Epoch 15/100<font></font>
21/21 [==============================] - 3s 129ms/step - loss: 0.0898 - binary_accuracy: 0.9643 - precision: 0.9901 - recall: 0.9614 - val_loss: 0.1525 - val_binary_accuracy: 0.9486 - val_precision: 0.9986 - val_recall: 0.9298<font></font>
Epoch 16/100<font></font>
21/21 [==============================] - 3s 128ms/step - loss: 0.0941 - binary_accuracy: 0.9621 - precision: 0.9904 - recall: 0.9582 - val_loss: 0.5101 - val_binary_accuracy: 0.8527 - val_precision: 1.0000 - val_recall: 0.7949<font></font>
Epoch 17/100<font></font>
21/21 [==============================] - 3s 125ms/step - loss: 0.0798 - binary_accuracy: 0.9636 - precision: 0.9897 - recall: 0.9607 - val_loss: 0.1239 - val_binary_accuracy: 0.9622 - val_precision: 0.9875 - val_recall: 0.9595<font></font>
Epoch 18/100<font></font>
21/21 [==============================] - 3s 126ms/step - loss: 0.0821 - binary_accuracy: 0.9657 - precision: 0.9911 - recall: 0.9623 - val_loss: 0.1597 - val_binary_accuracy: 0.9322 - val_precision: 0.9956 - val_recall: 0.9096<font></font>
Epoch 19/100<font></font>
21/21 [==============================] - 3s 143ms/step - loss: 0.0800 - binary_accuracy: 0.9657 - precision: 0.9917 - recall: 0.9617 - val_loss: 0.2538 - val_binary_accuracy: 0.9109 - val_precision: 1.0000 - val_recall: 0.8758<font></font>
Epoch 20/100<font></font>
21/21 [==============================] - 3s 127ms/step - loss: 0.0605 - binary_accuracy: 0.9738 - precision: 0.9950 - recall: 0.9694 - val_loss: 0.6594 - val_binary_accuracy: 0.8566 - val_precision: 1.0000 - val_recall: 0.8003<font></font>
Epoch 21/100<font></font>
21/21 [==============================] - 4s 167ms/step - loss: 0.0726 - binary_accuracy: 0.9733 - precision: 0.9937 - recall: 0.9701 - val_loss: 0.0593 - val_binary_accuracy: 0.9816 - val_precision: 0.9945 - val_recall: 0.9798<font></font>
Epoch 22/100<font></font>
21/21 [==============================] - 3s 126ms/step - loss: 0.0577 - binary_accuracy: 0.9783 - precision: 0.9951 - recall: 0.9755 - val_loss: 0.1087 - val_binary_accuracy: 0.9729 - val_precision: 0.9931 - val_recall: 0.9690<font></font>
Epoch 23/100<font></font>
21/21 [==============================] - 3s 125ms/step - loss: 0.0652 - binary_accuracy: 0.9729 - precision: 0.9924 - recall: 0.9707 - val_loss: 1.8465 - val_binary_accuracy: 0.7180 - val_precision: 0.7180 - val_recall: 1.0000<font></font>
Epoch 24/100<font></font>
21/21 [==============================] - 3s 124ms/step - loss: 0.0538 - binary_accuracy: 0.9783 - precision: 0.9951 - recall: 0.9755 - val_loss: 1.5769 - val_binary_accuracy: 0.7180 - val_precision: 0.7180 - val_recall: 1.0000<font></font>
Epoch 25/100<font></font>
21/21 [==============================] - 4s 167ms/step - loss: 0.0549 - binary_accuracy: 0.9776 - precision: 0.9954 - recall: 0.9743 - val_loss: 0.0590 - val_binary_accuracy: 0.9777 - val_precision: 0.9904 - val_recall: 0.9784<font></font>
Epoch 26/100<font></font>
21/21 [==============================] - 3s 131ms/step - loss: 0.0677 - binary_accuracy: 0.9719 - precision: 0.9924 - recall: 0.9694 - val_loss: 2.6008 - val_binary_accuracy: 0.6928 - val_precision: 0.9977 - val_recall: 0.5735<font></font>
Epoch 27/100<font></font>
21/21 [==============================] - 3s 127ms/step - loss: 0.0469 - binary_accuracy: 0.9833 - precision: 0.9971 - recall: 0.9804 - val_loss: 1.0184 - val_binary_accuracy: 0.8605 - val_precision: 0.9983 - val_recall: 0.8070<font></font>
Epoch 28/100<font></font>
21/21 [==============================] - 3s 126ms/step - loss: 0.0501 - binary_accuracy: 0.9790 - precision: 0.9961 - recall: 0.9755 - val_loss: 0.3737 - val_binary_accuracy: 0.9089 - val_precision: 0.9954 - val_recall: 0.8772<font></font>
Epoch 29/100<font></font>
21/21 [==============================] - 3s 128ms/step - loss: 0.0548 - binary_accuracy: 0.9798 - precision: 0.9941 - recall: 0.9784 - val_loss: 1.2928 - val_binary_accuracy: 0.7907 - val_precision: 1.0000 - val_recall: 0.7085<font></font>
Epoch 30/100<font></font>
21/21 [==============================] - 3s 129ms/step - loss: 0.0370 - binary_accuracy: 0.9860 - precision: 0.9980 - recall: 0.9829 - val_loss: 0.1370 - val_binary_accuracy: 0.9612 - val_precision: 0.9972 - val_recall: 0.9487<font></font>
Epoch 31/100<font></font>
21/21 [==============================] - 3s 125ms/step - loss: 0.0585 - binary_accuracy: 0.9819 - precision: 0.9951 - recall: 0.9804 - val_loss: 1.1955 - val_binary_accuracy: 0.6870 - val_precision: 0.9976 - val_recall: 0.5655<font></font>
Epoch 32/100<font></font>
21/21 [==============================] - 3s 140ms/step - loss: 0.0813 - binary_accuracy: 0.9695 - precision: 0.9934 - recall: 0.9652 - val_loss: 1.0394 - val_binary_accuracy: 0.8576 - val_precision: 0.9853 - val_recall: 0.8138<font></font>
Epoch 33/100<font></font>
21/21 [==============================] - 3s 128ms/step - loss: 0.1111 - binary_accuracy: 0.9555 - precision: 0.9870 - recall: 0.9524 - val_loss: 4.9438 - val_binary_accuracy: 0.5911 - val_precision: 1.0000 - val_recall: 0.4305<font></font>
Epoch 34/100<font></font>
21/21 [==============================] - 3s 130ms/step - loss: 0.0680 - binary_accuracy: 0.9726 - precision: 0.9921 - recall: 0.9707 - val_loss: 2.8822 - val_binary_accuracy: 0.7267 - val_precision: 0.9978 - val_recall: 0.6208<font></font>
Epoch 35/100<font></font>
21/21 [==============================] - 4s 187ms/step - loss: 0.0784 - binary_accuracy: 0.9712 - precision: 0.9892 - recall: 0.9717 - val_loss: 0.3940 - val_binary_accuracy: 0.9390 - val_precision: 0.9942 - val_recall: 0.9204<font></font>
</code></pre></div>


</div>
<hr>
<h2 id="visualizing-model-performance">Visualizing model performance</h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hãy vẽ biểu đồ độ chính xác và mất mát của mô hình cho tập huấn luyện và tập xác thực. Lưu ý rằng không có hạt giống ngẫu nhiên nào được chỉ định cho sổ ghi chép này. Đối với sổ ghi chép của bạn, có thể có một chút sai lệch.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><font></font>
<font></font>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">met</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">"precision"</span><span class="p">,</span> <span class="s2">"recall"</span><span class="p">,</span> <span class="s2">"binary_accuracy"</span><span class="p">,</span> <span class="s2">"loss"</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">met</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">"val_"</span> <span class="o">+</span> <span class="n">met</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Model </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">met</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"epochs"</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">met</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"train"</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">])</span>
</code></pre></div>

<p><img alt="png" src="./aaa_files/xray_classification_with_tpus_41_0.png"></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chúng ta thấy rằng độ chính xác của mô hình của chúng tôi là khoảng 95%.</font></font></p>
<hr>
<h2 id="predict-and-evaluate-results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dự đoán và đánh giá kết quả</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hãy cùng đánh giá mô hình trên dữ liệu thử nghiệm của chúng ta!</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_ds</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>4/4 [==============================] - 3s 708ms/step - loss: 0.9718 - binary_accuracy: 0.7901 - precision: 0.7524 - recall: 0.9897<font></font>
<font></font>
{'binary_accuracy': 0.7900640964508057,<font></font>
 'loss': 0.9717951416969299,<font></font>
 'precision': 0.752436637878418,<font></font>
 'recall': 0.9897436499595642}<font></font>
</code></pre></div>


</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chúng tôi thấy rằng độ chính xác của chúng tôi trên dữ liệu thử nghiệm thấp hơn độ chính xác của tập xác thực của chúng tôi. Điều này có thể chỉ ra sự quá khớp.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Khả năng nhớ lại của chúng tôi lớn hơn độ chính xác, cho thấy hầu hết các hình ảnh viêm phổi đều được xác định chính xác nhưng một số hình ảnh bình thường lại bị xác định sai. Chúng ta nên hướng tới mục tiêu tăng độ chính xác.</font></font></p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">test_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">CLASS_NAMES</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()])</span><font></font>
<font></font>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">prediction</span><span class="p">]</span><font></font>
<font></font>
<span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">CLASS_NAMES</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"This image is </span><span class="si">%.2f</span><span class="s2"> percent </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">((</span><span class="mi">100</span> <span class="o">*</span> <span class="n">score</span><span class="p">),</span> <span class="n">name</span><span class="p">))</span>
</code></pre></div>

<div class="k-default-codeblock">

<div class="codehilite"><pre><span></span><code>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:3: DeprecationWarning: In future, it will be an error for 'np.bool_' scalars to be interpreted as an index<font></font>
  This is separate from the ipykernel package so we can avoid doing imports until<font></font>
<font></font>
This image is 47.19 percent NORMAL<font></font>
This image is 52.81 percent PNEUMONIA<font></font>
</code></pre></div>


</div>
<p><img alt="png" src="./aaa_files/xray_classification_with_tpus_46_2.png"></p>
        </div>
        
        <div class="k-outline">
          
            <div class="k-outline-depth-1">
              
              <a href="https://keras.io/examples/vision/xray_classification_with_tpus/#pneumonia-classification-on-tpu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phân loại viêm phổi trên TPU</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#introduction--setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Giới thiệu + Thiết lập</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#load-the-data"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tải dữ liệu</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#visualize-the-dataset"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hình dung tập dữ liệu</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#build-the-cnn"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xây dựng CNN</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#correct-for-data-imbalance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sửa lỗi mất cân bằng dữ liệu</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#train-the-model"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Đào tạo mô hình</font></font></a>
            </div>
          
            <div class="k-outline-depth-3">
              
              <a href="https://keras.io/examples/vision/xray_classification_with_tpus/#defining-callbacks"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Định nghĩa các lệnh gọi lại</font></font></a>
            </div>
          
            <div class="k-outline-depth-3">
              
              <a href="https://keras.io/examples/vision/xray_classification_with_tpus/#fit-the-model"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phù hợp với mô hình</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#visualizing-model-performance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hình dung hiệu suất mô hình</font></font></a>
            </div>
          
            <div class="k-outline-depth-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
               ◆  
               </font></font><a href="https://keras.io/examples/vision/xray_classification_with_tpus/#predict-and-evaluate-results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dự đoán và đánh giá kết quả</font></font></a>
            </div>
          
        </div>
        
      </div>
    </div>

  </div>



<footer style="float: left; width: 100%; padding: 1em; border-top: solid 1px #bbb;">
  <a href="https://policies.google.com/terms"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Điều khoản</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font><a href="https://policies.google.com/privacy"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quyền riêng tư</font></font></a>
</footer>

<div id="goog-gt-tt" class="VIpgJd-yAWNEb-L7lbkb skiptranslate" style="border-radius: 12px; margin: 0 0 0 -23px; padding: 0; font-family: &#39;Google Sans&#39;, Arial, sans-serif;" data-id=""><div id="goog-gt-vt" class="VIpgJd-yAWNEb-hvhgNd"><div class=" VIpgJd-yAWNEb-hvhgNd-l4eHX-i3jM8c"><img src="./aaa_files/24px.svg" width="24" height="24" alt=""></div><div class=" VIpgJd-yAWNEb-hvhgNd-k77Iif-i3jM8c"><div class="VIpgJd-yAWNEb-hvhgNd-IuizWc" dir="ltr">Original text</div><div id="goog-gt-original-text" class="VIpgJd-yAWNEb-nVMfcd-fmcmS VIpgJd-yAWNEb-hvhgNd-axAV1"></div></div><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid ltr"><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid-B7I4Od ltr" dir="ltr"><div class="VIpgJd-yAWNEb-hvhgNd-UTujCb">Rate this translation</div><div class="VIpgJd-yAWNEb-hvhgNd-eO9mKe">Your feedback will be used to help improve Google Translate</div></div><div class="VIpgJd-yAWNEb-hvhgNd-xgov5 ltr"><button id="goog-gt-thumbUpButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="Good translation" aria-label="Good translation" aria-pressed="false"><span id="goog-gt-thumbUpIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7H2v13h16c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM7 18H4V9h3v9zm14-7l-3 7H9V8l4.34-4.34L12 9h9v2z"></path></svg></span><span id="goog-gt-thumbUpIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7v13h11c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM5 7H1v13h4V7z"></path></svg></span></button><button id="goog-gt-thumbDownButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="Poor translation" aria-label="Poor translation" aria-pressed="false"><span id="goog-gt-thumbDownIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7h5V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zM17 6h3v9h-3V6zM3 13l3-7h9v10l-4.34 4.34L12 15H3v-2z"></path></svg></span><span id="goog-gt-thumbDownIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zm16 0h4V4h-4v13z"></path></svg></span></button></div></div><div id="goog-gt-votingHiddenPane" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><form id="goog-gt-votingForm" action="https://translate.googleapis.com/translate_voting?client=te_lib" method="post" target="votingFrame" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><input type="text" name="sl" id="goog-gt-votingInputSrcLang"><input type="text" name="tl" id="goog-gt-votingInputTrgLang"><input type="text" name="query" id="goog-gt-votingInputSrcText"><input type="text" name="gtrans" id="goog-gt-votingInputTrgText"><input type="text" name="vote" id="goog-gt-votingInputVote"></form><iframe name="votingFrame" frameborder="0" src="./aaa_files/saved_resource.html"></iframe></div></div></div><div id="yt_article_summary_widget_wrapper" class="yt_article_summary_widget_wrapper" style="display: none;">
        <div id="yt_article_summary_widget" class="yt_article_summary_widget"><svg style="filter: brightness(0.8);" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <mask id="path-1-outside-1_3606_3145" maskUnits="userSpaceOnUse" x="1" y="1" width="22" height="22" fill="black">
                  <rect fill="white" x="1" y="1" width="22" height="22"></rect>
                  <path d="M20.6816 10.1843C20.9588 9.34066 21.0063 8.4399 20.8192 7.57245C20.6321 6.70499 20.217 5.90134 19.6157 5.24216C19.0143 4.58298 18.2478 4.09146 17.393 3.81692C16.5382 3.54238 15.6253 3.49449 14.7459 3.67805C14.1453 3.01747 13.379 2.52468 12.524 2.24931C11.669 1.97394 10.7555 1.92571 9.87559 2.10947C8.99568 2.29324 8.18039 2.70252 7.51181 3.29608C6.84323 3.88965 6.34499 4.64654 6.06725 5.49055C5.18642 5.67292 4.3699 6.08122 3.70003 6.67426C3.03017 7.26731 2.53064 8.02413 2.25182 8.86842C1.97299 9.71271 1.92474 10.6146 2.11192 11.4832C2.2991 12.3517 2.71509 13.1562 3.31795 13.8155C3.09309 14.4899 3.01633 15.2037 3.09278 15.9095C3.16924 16.6154 3.39716 17.2971 3.76139 17.9093C4.30169 18.8351 5.12567 19.568 6.11483 20.0027C7.104 20.4373 8.20738 20.5512 9.26631 20.328C9.74353 20.8568 10.3291 21.2796 10.9844 21.5684C11.6396 21.8571 12.3495 22.0053 13.0672 22.003C14.1516 22.003 15.2081 21.6635 16.0847 21.0334C16.9612 20.4034 17.6125 19.5152 17.9449 18.4968C18.649 18.3539 19.3141 18.0649 19.8962 17.6489C20.4784 17.233 20.9642 16.6997 21.3214 16.0843C21.8585 15.1598 22.0858 14.0915 21.9709 13.032C21.856 11.9724 21.4048 10.9758 20.6816 10.1843ZM13.0798 20.6968C12.191 20.6968 11.3302 20.3894 10.6473 19.828L10.7677 19.7593L14.8029 17.4593C14.9069 17.4047 14.9935 17.3225 15.0528 17.2221C15.1121 17.1216 15.1418 17.0068 15.1386 16.8905V11.2655L16.8427 12.2405C16.8517 12.2441 16.8594 12.2501 16.865 12.2579C16.8706 12.2656 16.8739 12.2748 16.8744 12.2843V16.9343C16.876 17.4289 16.7785 17.9189 16.5875 18.3761C16.3964 18.8333 16.1156 19.2488 15.7611 19.5985C15.4067 19.9482 14.9856 20.2253 14.5222 20.4138C14.0588 20.6023 13.5621 20.6984 13.0608 20.6968H13.0798ZM4.90165 17.2593C4.46164 16.5029 4.3026 15.6189 4.45188 14.7593L4.57224 14.828L8.60749 17.128C8.70379 17.1829 8.81303 17.2118 8.92423 17.2118C9.03543 17.2118 9.14467 17.1829 9.24097 17.128L14.1758 14.3218V16.253C14.1797 16.2608 14.1817 16.2694 14.1817 16.278C14.1817 16.2867 14.1797 16.2953 14.1758 16.303L10.0962 18.628C9.66403 18.8748 9.18685 19.0352 8.69188 19.0999C8.19692 19.1647 7.69387 19.1326 7.21148 19.0055C6.72909 18.8784 6.27681 18.6587 5.88048 18.3591C5.48415 18.0595 5.15154 17.6858 4.90165 17.2593ZM3.83741 8.5843C4.28764 7.82089 4.99655 7.23878 5.83919 6.94055V11.6718C5.83595 11.7857 5.86434 11.8983 5.92128 11.9975C5.97823 12.0966 6.06156 12.1785 6.16227 12.2343L11.0717 15.028L9.36766 16.003C9.34918 16.0092 9.32914 16.0092 9.31065 16.003L5.23106 13.678C4.36041 13.1812 3.72487 12.3642 3.46364 11.4059C3.20242 10.4476 3.33682 9.42624 3.83741 8.56555V8.5843ZM17.8563 11.7968L12.9278 8.9718L14.6319 8.00305C14.6403 7.99741 14.6502 7.99439 14.6604 7.99439C14.6705 7.99439 14.6805 7.99741 14.6889 8.00305L18.7685 10.328C19.3915 10.684 19.8992 11.2072 20.2325 11.8368C20.5659 12.4664 20.7111 13.1764 20.6514 13.8843C20.5916 14.5921 20.3294 15.2687 19.8951 15.8352C19.4608 16.4017 18.8724 16.8349 18.1983 17.0843V12.353C18.1946 12.2391 18.1612 12.1281 18.1013 12.0306C18.0414 11.9332 17.957 11.8527 17.8563 11.7968ZM19.554 9.2968L19.4336 9.2218L15.4047 6.9093C15.3047 6.84846 15.1896 6.81624 15.0721 6.81624C14.9547 6.81624 14.8395 6.84846 14.7396 6.9093L9.8111 9.71555V7.75305C9.8061 7.7445 9.80346 7.7348 9.80346 7.72492C9.80346 7.71505 9.8061 7.70535 9.8111 7.6968L13.897 5.37805C14.5222 5.02257 15.2371 4.85003 15.958 4.88059C16.6789 4.91115 17.3762 5.14356 17.9682 5.55064C18.5601 5.95772 19.0225 6.52265 19.301 7.17939C19.5796 7.83614 19.663 8.55755 19.5413 9.2593L19.554 9.2968ZM8.87989 12.7218L7.1695 11.753C7.15339 11.7405 7.1422 11.7228 7.13782 11.703V7.06555C7.13785 6.35289 7.34371 5.65499 7.73128 5.0536C8.11885 4.45222 8.67209 3.97224 9.32619 3.6699C9.98029 3.36756 10.7082 3.25537 11.4246 3.34647C12.141 3.43757 12.8162 3.7282 13.3712 4.1843L13.2636 4.25305L9.21563 6.55305C9.11158 6.60765 9.02504 6.68981 8.96573 6.79029C8.90642 6.89076 8.87669 7.00557 8.87989 7.1218V12.7218ZM9.80476 10.753L11.9966 9.50305L14.1948 10.753V13.253L11.9966 14.503L9.79843 13.253L9.80476 10.753Z"></path>
                  </mask>
                  <path d="M20.6816 10.1843C20.9588 9.34066 21.0063 8.4399 20.8192 7.57245C20.6321 6.70499 20.217 5.90134 19.6157 5.24216C19.0143 4.58298 18.2478 4.09146 17.393 3.81692C16.5382 3.54238 15.6253 3.49449 14.7459 3.67805C14.1453 3.01747 13.379 2.52468 12.524 2.24931C11.669 1.97394 10.7555 1.92571 9.87559 2.10947C8.99568 2.29324 8.18039 2.70252 7.51181 3.29608C6.84323 3.88965 6.34499 4.64654 6.06725 5.49055C5.18642 5.67292 4.3699 6.08122 3.70003 6.67426C3.03017 7.26731 2.53064 8.02413 2.25182 8.86842C1.97299 9.71271 1.92474 10.6146 2.11192 11.4832C2.2991 12.3517 2.71509 13.1562 3.31795 13.8155C3.09309 14.4899 3.01633 15.2037 3.09278 15.9095C3.16924 16.6154 3.39716 17.2971 3.76139 17.9093C4.30169 18.8351 5.12567 19.568 6.11483 20.0027C7.104 20.4373 8.20738 20.5512 9.26631 20.328C9.74353 20.8568 10.3291 21.2796 10.9844 21.5684C11.6396 21.8571 12.3495 22.0053 13.0672 22.003C14.1516 22.003 15.2081 21.6635 16.0847 21.0334C16.9612 20.4034 17.6125 19.5152 17.9449 18.4968C18.649 18.3539 19.3141 18.0649 19.8962 17.6489C20.4784 17.233 20.9642 16.6997 21.3214 16.0843C21.8585 15.1598 22.0858 14.0915 21.9709 13.032C21.856 11.9724 21.4048 10.9758 20.6816 10.1843ZM13.0798 20.6968C12.191 20.6968 11.3302 20.3894 10.6473 19.828L10.7677 19.7593L14.8029 17.4593C14.9069 17.4047 14.9935 17.3225 15.0528 17.2221C15.1121 17.1216 15.1418 17.0068 15.1386 16.8905V11.2655L16.8427 12.2405C16.8517 12.2441 16.8594 12.2501 16.865 12.2579C16.8706 12.2656 16.8739 12.2748 16.8744 12.2843V16.9343C16.876 17.4289 16.7785 17.9189 16.5875 18.3761C16.3964 18.8333 16.1156 19.2488 15.7611 19.5985C15.4067 19.9482 14.9856 20.2253 14.5222 20.4138C14.0588 20.6023 13.5621 20.6984 13.0608 20.6968H13.0798ZM4.90165 17.2593C4.46164 16.5029 4.3026 15.6189 4.45188 14.7593L4.57224 14.828L8.60749 17.128C8.70379 17.1829 8.81303 17.2118 8.92423 17.2118C9.03543 17.2118 9.14467 17.1829 9.24097 17.128L14.1758 14.3218V16.253C14.1797 16.2608 14.1817 16.2694 14.1817 16.278C14.1817 16.2867 14.1797 16.2953 14.1758 16.303L10.0962 18.628C9.66403 18.8748 9.18685 19.0352 8.69188 19.0999C8.19692 19.1647 7.69387 19.1326 7.21148 19.0055C6.72909 18.8784 6.27681 18.6587 5.88048 18.3591C5.48415 18.0595 5.15154 17.6858 4.90165 17.2593ZM3.83741 8.5843C4.28764 7.82089 4.99655 7.23878 5.83919 6.94055V11.6718C5.83595 11.7857 5.86434 11.8983 5.92128 11.9975C5.97823 12.0966 6.06156 12.1785 6.16227 12.2343L11.0717 15.028L9.36766 16.003C9.34918 16.0092 9.32914 16.0092 9.31065 16.003L5.23106 13.678C4.36041 13.1812 3.72487 12.3642 3.46364 11.4059C3.20242 10.4476 3.33682 9.42624 3.83741 8.56555V8.5843ZM17.8563 11.7968L12.9278 8.9718L14.6319 8.00305C14.6403 7.99741 14.6502 7.99439 14.6604 7.99439C14.6705 7.99439 14.6805 7.99741 14.6889 8.00305L18.7685 10.328C19.3915 10.684 19.8992 11.2072 20.2325 11.8368C20.5659 12.4664 20.7111 13.1764 20.6514 13.8843C20.5916 14.5921 20.3294 15.2687 19.8951 15.8352C19.4608 16.4017 18.8724 16.8349 18.1983 17.0843V12.353C18.1946 12.2391 18.1612 12.1281 18.1013 12.0306C18.0414 11.9332 17.957 11.8527 17.8563 11.7968ZM19.554 9.2968L19.4336 9.2218L15.4047 6.9093C15.3047 6.84846 15.1896 6.81624 15.0721 6.81624C14.9547 6.81624 14.8395 6.84846 14.7396 6.9093L9.8111 9.71555V7.75305C9.8061 7.7445 9.80346 7.7348 9.80346 7.72492C9.80346 7.71505 9.8061 7.70535 9.8111 7.6968L13.897 5.37805C14.5222 5.02257 15.2371 4.85003 15.958 4.88059C16.6789 4.91115 17.3762 5.14356 17.9682 5.55064C18.5601 5.95772 19.0225 6.52265 19.301 7.17939C19.5796 7.83614 19.663 8.55755 19.5413 9.2593L19.554 9.2968ZM8.87989 12.7218L7.1695 11.753C7.15339 11.7405 7.1422 11.7228 7.13782 11.703V7.06555C7.13785 6.35289 7.34371 5.65499 7.73128 5.0536C8.11885 4.45222 8.67209 3.97224 9.32619 3.6699C9.98029 3.36756 10.7082 3.25537 11.4246 3.34647C12.141 3.43757 12.8162 3.7282 13.3712 4.1843L13.2636 4.25305L9.21563 6.55305C9.11158 6.60765 9.02504 6.68981 8.96573 6.79029C8.90642 6.89076 8.87669 7.00557 8.87989 7.1218V12.7218ZM9.80476 10.753L11.9966 9.50305L14.1948 10.753V13.253L11.9966 14.503L9.79843 13.253L9.80476 10.753Z" fill="#828282"></path>
                  <path d="M20.6816 10.1843C20.9588 9.34066 21.0063 8.4399 20.8192 7.57245C20.6321 6.70499 20.217 5.90134 19.6157 5.24216C19.0143 4.58298 18.2478 4.09146 17.393 3.81692C16.5382 3.54238 15.6253 3.49449 14.7459 3.67805C14.1453 3.01747 13.379 2.52468 12.524 2.24931C11.669 1.97394 10.7555 1.92571 9.87559 2.10947C8.99568 2.29324 8.18039 2.70252 7.51181 3.29608C6.84323 3.88965 6.34499 4.64654 6.06725 5.49055C5.18642 5.67292 4.3699 6.08122 3.70003 6.67426C3.03017 7.26731 2.53064 8.02413 2.25182 8.86842C1.97299 9.71271 1.92474 10.6146 2.11192 11.4832C2.2991 12.3517 2.71509 13.1562 3.31795 13.8155C3.09309 14.4899 3.01633 15.2037 3.09278 15.9095C3.16924 16.6154 3.39716 17.2971 3.76139 17.9093C4.30169 18.8351 5.12567 19.568 6.11483 20.0027C7.104 20.4373 8.20738 20.5512 9.26631 20.328C9.74353 20.8568 10.3291 21.2796 10.9844 21.5684C11.6396 21.8571 12.3495 22.0053 13.0672 22.003C14.1516 22.003 15.2081 21.6635 16.0847 21.0334C16.9612 20.4034 17.6125 19.5152 17.9449 18.4968C18.649 18.3539 19.3141 18.0649 19.8962 17.6489C20.4784 17.233 20.9642 16.6997 21.3214 16.0843C21.8585 15.1598 22.0858 14.0915 21.9709 13.032C21.856 11.9724 21.4048 10.9758 20.6816 10.1843ZM13.0798 20.6968C12.191 20.6968 11.3302 20.3894 10.6473 19.828L10.7677 19.7593L14.8029 17.4593C14.9069 17.4047 14.9935 17.3225 15.0528 17.2221C15.1121 17.1216 15.1418 17.0068 15.1386 16.8905V11.2655L16.8427 12.2405C16.8517 12.2441 16.8594 12.2501 16.865 12.2579C16.8706 12.2656 16.8739 12.2748 16.8744 12.2843V16.9343C16.876 17.4289 16.7785 17.9189 16.5875 18.3761C16.3964 18.8333 16.1156 19.2488 15.7611 19.5985C15.4067 19.9482 14.9856 20.2253 14.5222 20.4138C14.0588 20.6023 13.5621 20.6984 13.0608 20.6968H13.0798ZM4.90165 17.2593C4.46164 16.5029 4.3026 15.6189 4.45188 14.7593L4.57224 14.828L8.60749 17.128C8.70379 17.1829 8.81303 17.2118 8.92423 17.2118C9.03543 17.2118 9.14467 17.1829 9.24097 17.128L14.1758 14.3218V16.253C14.1797 16.2608 14.1817 16.2694 14.1817 16.278C14.1817 16.2867 14.1797 16.2953 14.1758 16.303L10.0962 18.628C9.66403 18.8748 9.18685 19.0352 8.69188 19.0999C8.19692 19.1647 7.69387 19.1326 7.21148 19.0055C6.72909 18.8784 6.27681 18.6587 5.88048 18.3591C5.48415 18.0595 5.15154 17.6858 4.90165 17.2593ZM3.83741 8.5843C4.28764 7.82089 4.99655 7.23878 5.83919 6.94055V11.6718C5.83595 11.7857 5.86434 11.8983 5.92128 11.9975C5.97823 12.0966 6.06156 12.1785 6.16227 12.2343L11.0717 15.028L9.36766 16.003C9.34918 16.0092 9.32914 16.0092 9.31065 16.003L5.23106 13.678C4.36041 13.1812 3.72487 12.3642 3.46364 11.4059C3.20242 10.4476 3.33682 9.42624 3.83741 8.56555V8.5843ZM17.8563 11.7968L12.9278 8.9718L14.6319 8.00305C14.6403 7.99741 14.6502 7.99439 14.6604 7.99439C14.6705 7.99439 14.6805 7.99741 14.6889 8.00305L18.7685 10.328C19.3915 10.684 19.8992 11.2072 20.2325 11.8368C20.5659 12.4664 20.7111 13.1764 20.6514 13.8843C20.5916 14.5921 20.3294 15.2687 19.8951 15.8352C19.4608 16.4017 18.8724 16.8349 18.1983 17.0843V12.353C18.1946 12.2391 18.1612 12.1281 18.1013 12.0306C18.0414 11.9332 17.957 11.8527 17.8563 11.7968ZM19.554 9.2968L19.4336 9.2218L15.4047 6.9093C15.3047 6.84846 15.1896 6.81624 15.0721 6.81624C14.9547 6.81624 14.8395 6.84846 14.7396 6.9093L9.8111 9.71555V7.75305C9.8061 7.7445 9.80346 7.7348 9.80346 7.72492C9.80346 7.71505 9.8061 7.70535 9.8111 7.6968L13.897 5.37805C14.5222 5.02257 15.2371 4.85003 15.958 4.88059C16.6789 4.91115 17.3762 5.14356 17.9682 5.55064C18.5601 5.95772 19.0225 6.52265 19.301 7.17939C19.5796 7.83614 19.663 8.55755 19.5413 9.2593L19.554 9.2968ZM8.87989 12.7218L7.1695 11.753C7.15339 11.7405 7.1422 11.7228 7.13782 11.703V7.06555C7.13785 6.35289 7.34371 5.65499 7.73128 5.0536C8.11885 4.45222 8.67209 3.97224 9.32619 3.6699C9.98029 3.36756 10.7082 3.25537 11.4246 3.34647C12.141 3.43757 12.8162 3.7282 13.3712 4.1843L13.2636 4.25305L9.21563 6.55305C9.11158 6.60765 9.02504 6.68981 8.96573 6.79029C8.90642 6.89076 8.87669 7.00557 8.87989 7.1218V12.7218ZM9.80476 10.753L11.9966 9.50305L14.1948 10.753V13.253L11.9966 14.503L9.79843 13.253L9.80476 10.753Z" stroke="#828282" stroke-width="0.2" mask="url(#path-1-outside-1_3606_3145)"></path>
              </svg></div>
        <div id="yt_article_summary_close_button" class="yt_article_summary_close_button"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">×</font></font></div>
    </div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="tích hợp ngữ pháp" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>